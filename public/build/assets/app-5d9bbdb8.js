class v{_manager;getKey(){return""}manager(d){this._manager=d}getManager(){return this._manager}register(){}booting(){}booted(){}dispose(){}}class m extends v{getKey(){return"SOKEIO_LIVEWIRE_GRAPESJS_MODULE"}booting(){if(window.Livewire){let n=this.getManager();const _=e=>{var t=document.createElement("div");t.innerHTML=e;var r=t.querySelector(".div-builder-component-plus");return r&&r.parentNode.removeChild(r),t.innerHTML=t.innerHTML.replace(/<span class="shortcode-highlight">(.*?)<\/span>/g,"$1"),t.innerHTML};window.Livewire.directive("grapesjs",({el:e,directive:t,component:r})=>{if(t.modifiers.length>0||e.livewire____grapesjs)return;let a={};e.hasAttribute("wire:grapesjs.options")&&(a=new Function(`return ${e.getAttribute("wire:grapesjs.options")};`)());const g=a.pluginManager??[];a?.pluginManager&&(a={...a,pluginManager:void 0});const c=i=>{var s='<span class="shortcode-highlight">',u="</span>",w=i.replace(/\[(\/?[^\]]+)\]/g,function(h,o){return o.startsWith("/")?"["+o+"]"+u:o.endsWith("/")?s+"["+o+"]"+u:s+"["+o+"]"});return w},p=()=>{e.livewire____grapesjs||(e.livewire____grapesjs=grapesjs.init({container:e,storageManager:!1,style:n.dataGet(r.$wire,"data.css"),components:n.dataGet(r.$wire,"data.content"),...a,plugins:g.map(function(i){return i.name}),pluginsOpts:g.reduce(function(i,s){return i[s.name]=s.options??{},i},{}),pages:!1,assetManager:{custom:{open(i){window.showFileManager(function(s){s&&s[0]&&s[0].url&&i.select(s[0].url),i.close()})},close(i){}}}}),e.livewire____grapesjs.Commands.add("sokeio-builder-save-data",{run:async function(i,s){s&&s.set("active",0),r.$wire.doSave()}}),e.livewire____grapesjs.on("change",function(){n.dataSet(r.$wire,"data.css",e.livewire____grapesjs.getCss()),n.dataSet(r.$wire,"data.content",_(e.livewire____grapesjs.getHtml())),n.dataSet(r.$wire,"data.js",e.livewire____grapesjs.getJs())}),e.livewire____grapesjs.on("load",function(){const i=c(n.dataGet(r.$wire,"data.content"));e.livewire____grapesjs.setComponents(i)}),e.livewire____grapesjs.on("stop:preview",()=>{e.closest(".sokeio-builder-manager").classList.remove("sokeio-builder-preview")}),e.livewire____grapesjs.on("run:preview",()=>{e.closest(".sokeio-builder-manager").classList.add("sokeio-builder-preview")}))};window.grapesjs?p():(window.SokeioLoadStyle("https://cdn.jsdelivr.net/npm/grapesjs@0.21.6/dist/css/grapes.min.css",...g.reduce(function(i,s){return[...i,...s.css??[]]},[])),window.SokeioLoadScript(["https://cdn.jsdelivr.net/npm/grapesjs@0.21.6/dist/grapes.min.js",...g.reduce(function(i,s){return[...i,...s.js??[]]},[])]).then(function(){p()}))})}}}window.addEventListener("sokeio::register",function(){SokeioManager.registerPlugin(m)});
